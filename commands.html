<html>
<head>
	<title>HM4 - command reference</title>
	<style><!--
	pre {
		border: dashed 1px black;
		padding: 10px;
	}

	a {
		font-weight: bold;
		color: #007;
	}

	div.cmd {
		padding-bottom: 10px;

		margin-top:     30px;
		margin-bottom:  30px;
	}

	div.cmd h2 {
		border-top:    solid 1px black;
		border-bottom: solid 1px black;

		background-color: #aaa;
		padding: 10px;
	}

	div.cmd i {
		background-color: #aaa;
		padding: 2px;
		font-style: normal;
	}

	div.cmd table.db {
		border: solid 1px #777;
		border-collapse: collapse;

		margin-top:    10px;
		margin-bottom: 10px;
	}

	div.cmd table {
		border: solid 3px black;
		border-collapse: collapse;
	}

	div.cmd table td {
		padding: 10px;
	}

	--></style>
</head>
<body>
<a target="#top"></a>

<h1>HM4 - command reference</h1>

<h2>List of commands</h2>

<ul>
	<li><a href="#GET	">GET		</a></li>
	<li><a href="#HGETALL	">HGETALL	</a></li>
	<li><a href="#GETX	">GETX		</a></li>
	<li><a href="#COUNT	">COUNT		</a></li>
	<li><a href="#SUM	">SUM		</a></li>
	<li><a href="#SET	">SET		</a></li>
	<li><a href="#SETEX	">SETEX		</a></li>
	<li><a href="#INCR	">INCR / INCRBY	</a></li>
	<li><a href="#DEL	">DEL		</a></li>
	<li><a href="#INFO	">INFO		</a></li>
	<li><a href="#SAVE	">SAVE / BGSAVE	</a></li>
	<li><a href="#EXIT	">EXIT		</a></li>
	<li><a href="#SHUTDOWN	">SHUTDOWN	</a></li>
</ul>



<div class="cmd" id="GET">
	<h2>GET key</h2>

	<h3>Description:</h3>

		Get value of the <i>key</i>. Exact match.

	<h3>Return value:</h3>

		Value of the key or empty string.

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.0.0		</td></tr>
			<tr><td>Time complexity		</td><td>O(log n)	</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>YES		</td></tr>
		</table>


</div>

<a href="#top">top</a>

<div class="cmd" id="HGETALL">
	<h2>HGETALL key [number=10]</h2>

	<h3>Description:</h3>

		Gets <i>number</i> of key-value pairs after <i>key</i>.
		Returns valid pairs and tombstones.

	<h3>Return value:</h3>

		array of keys and values

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.0.0		</td></tr>
			<tr><td>Time complexity		</td><td>O(log n)+line	</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>YES		</td></tr>
		</table>
</div>

<a href="#top">top</a>

<div class="cmd" id="HGETALL">
	<h2>HGETALL key number prefix</h2>

	<h3>Description:</h3>

		Gets <i>number</i> of key-value pairs after <i>key</i>.
		Returns valid pairs and tombstones, but only if they are matching the <u>prefix</u>.

	<h3>Return value:</h3>

		array of key and values

	<h3>Return value:</h3>

		array of keys and values

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.1.0		</td></tr>
			<tr><td>Time complexity		</td><td>O(log n)+line	</td></tr>
			<tr><td>Redis compatible	</td><td>NO		</td></tr>
			<tr><td>Blobs as values		</td><td>YES		</td></tr>
		</table>

	<h3>Example:</h3>

		Suppose we have this user database:

		<table border="1" class="db">
			<tr><td>u:123:email		</td><td>office@domain.com		</td></tr>
			<tr><td>u:123:country		</td><td>US				</td></tr>
			<tr><td>u:123:city		</td><td>Boston				</td></tr>
		</table>

		You can get this user's information records with following command:<br />
		<br />
		<i>hgetall u:123: 1000 u:123:</i>
</div>

<a href="#top">top</a>

<div class="cmd" id="GETX">
	<h2>GETX key number prefix</h2>

	<h3>Description:</h3>

		Gets <i>number</i> of key-value pairs after <i>key</i>.
		Returns ONLY valid pairs, but only if they are matching the <u>prefix</u>.

	<h3>Return value:</h3>

	<ul>
		<li>array of key and values</li>
		<li>last key, if there is second page</li>
	</ul>

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.2.5		</td></tr>
			<tr><td>Time complexity		</td><td>O(log n)+line	</td></tr>
			<tr><td>Redis compatible	</td><td>NO		</td></tr>
			<tr><td>Blobs as values		</td><td>YES		</td></tr>
		</table>

	<h3>Example:</h3>

		Suppose we have this user database:

		<table border="1" class="db">
			<tr><td>u:123:email		</td><td>office@domain.com		</td></tr>
			<tr><td>u:123:country		</td><td>US				</td></tr>
			<tr><td>u:123:city		</td><td>Boston				</td></tr>
		</table>

		You can get this user's information records with following command:<br />
		<br />
		<i>getx u:123: 1000 u:123:</i>

</div>

<a href="#top">top</a>

<div class="cmd" id="COUNT">
	<h2>COUNT key number prefix</h2>


	<h3>Description:</h3>

	Aggregate using COUNT <i>number</i> key-value pairs after <i>key</i>
	Aggregate ONLY valid pairs, but only if they are matching the <u>prefix</u>.

	<h3>Return value:</h3>

	<ul>
		<li>count of valid elements</li>
		<li>last key, if there is second page</li>
	</ul>

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.2.4		</td></tr>
			<tr><td>Time complexity		</td><td>O(log n)+line	</td></tr>
			<tr><td>Redis compatible	</td><td>NO		</td></tr>
			<tr><td>Blobs as values		</td><td>N/A		</td></tr>
		</table>

	<h3>Example:</h3>

		Suppose we have this user database:

		<table border="1" class="db">
			<tr><td>u:123:email		</td><td>office@domain.com		</td></tr>
			<tr><td>u:123:country		</td><td>US				</td></tr>
			<tr><td>u:123:city		</td><td>Boston				</td></tr>
		</table>

		You can get the count user's information records with following command:<br />
		<br />
		<i>count u:123: 1000 u:123:</i>
</div>

<a href="#top">top</a>

<div class="cmd" id="SUM">
	<h2>SUM key number prefix</h2>

	<pre>sum [key] [number] [prefix]</pre>

	<h3>Description:</h3>

	Aggregate using SUM <i>number</i> key-value pairs after <i>key</i>
	Aggregate ONLY valid pairs, but only if they are matching the <u>prefix</u>.

	<h3>Return value:</h3>

	<ul>
		<li>sum of valid elements</li>
		<li>last key, if there is second page</li>
	</ul>


	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.2.4		</td></tr>
			<tr><td>Time complexity		</td><td>O(log n)+line	</td></tr>
			<tr><td>Redis compatible	</td><td>NO		</td></tr>
			<tr><td>Blobs as values		</td><td>N/A		</td></tr>
		</table>

	<h3>Example:</h3>

		Suppose we have this sales database:

		<table border="1" class="db">
			<tr><td>sales:2020-01-01</td><td>12</td></tr>
			<tr><td>sales:2020-01-02</td><td>21</td></tr>
			<tr><td>sales:2020-01-03</td><td>35</td></tr>
		</table>

		You can get this sum of sales for Jan.2020 with following command:<br />
		<br />
		<i>sum sales:2020-01- 1000 sales:2020-01-</i>

</div>

<a href="#top">top</a>

<div class="cmd" id="SET">
	<h2>SET key value</h2>

	<h3>Description:</h3>

		Set <i>key</i> -> <i>value</i> pair.

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.0.0		</td></tr>
			<tr><td>Time complexity		</td><td>O(1)		</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>YES		</td></tr>
			<tr><td>Mutable			</td><td>YES		</td></tr>
		</table>

</div>

<a href="#top">top</a>

<div class="cmd" id="SETEX">
	<h2>SETEX key seconds value</h2>

	<h3>Description:</h3>

		Set <i>key</i> -> <i>value</i> pair with expiration of <i>seconds</i> seconds.<br />
		This command allows HM4 to be used as session handler for PHP servers.

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.0.0		</td></tr>
			<tr><td>Time complexity		</td><td>O(1)		</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>YES		</td></tr>
			<tr><td>Mutable			</td><td>YES		</td></tr>
		</table>
</div>

<a href="#top">top</a>

<div class="cmd" id="INCR">
	<h2>INCR / INCRBY key [increase value=1]</h2>

	<h3>Description:</h3>

		Increase numerical value of the <i>key</i> with  <i>increase value</i>.<br />
		It uses <b>int64_t</b> as a number type.

	<h3>Return value:</h3>

		New increased value.

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.1.0		</td></tr>
			<tr><td>Time complexity		</td><td>O(log n)	</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>N/A		</td></tr>
			<tr><td>Mutable			</td><td>YES		</td></tr>
		</table>
</div>

<a href="#top">top</a>

<div class="cmd" id="DEL">
	<h2>DEL</h2>

	<h3>Description:</h3>
		Removes [key] from the server.

	<h3>Return value:</h3>

		New increased value.

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.0.0		</td></tr>
			<tr><td>Time complexity		</td><td>O(1)		</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>N/A		</td></tr>
			<tr><td>Mutable			</td><td>YES		</td></tr>
		</table>

</div>

<a href="#top">top</a>

<div class="cmd" id="INFO">
	<h2>INFO</h2>

	<h3>Description:</h3>

		Returns server information.

	<h3>Return value:</h3>

		String with information.

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.0.0		</td></tr>
			<tr><td>Time complexity		</td><td>N/A		</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>N/A		</td></tr>
		</table>

</div>

<a href="#top">top</a>

<div class="cmd" id="SAVE">
	<h2>SAVE / BGSAVE [complete = 0]</h2>

	<h3>Description:</h3>

		<h4>On Mutable servers:</h4>

			Flushes memtable on the disk and reloads the disktables.<br />
			If <i>complete</i> is present, it suppose to bypass memtable flush,
			but current implementation is not 100% clear and might change in near future.

		<h4>On Mutable servers:</h4>
			Reloads the disktable(s).<br />
			<i>complete</i> options is ignored.

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.0.0		</td></tr>
			<tr><td>Time complexity		</td><td>N/A		</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>N/A		</td></tr>
		</table>

</div>

<a href="#top">top</a>

<div class="cmd" id="EXIT">
	<h2>EXIT</h2>

	<h3>Description:</h3>

		Disconnect from the server.

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.0.0		</td></tr>
			<tr><td>Time complexity		</td><td>N/A		</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>N/A		</td></tr>
		</table>

</div>

<a href="#top">top</a>

<div class="cmd" id="SHUTDOWN">
	<h2>SHUTDOWN</h2>

	<h3>Description:</h3>

		Shutdowns the server.<br />
		SAVE / NOSAVE is not supported yet.

	<h3>Info:</h3>

		<table border="1">
			<tr><td>Available since		</td><td>1.0.0		</td></tr>
			<tr><td>Time complexity		</td><td>N/A		</td></tr>
			<tr><td>Redis compatible	</td><td>YES		</td></tr>
			<tr><td>Blobs as values		</td><td>N/A		</td></tr>
		</table>

</div>

<a href="#top">top</a>

</body>
</html>

